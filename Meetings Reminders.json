{
  "name": "Meetings Reminders",
  "nodes": [
    {
      "parameters": {
        "operation": "delete",
        "documentId": {
          "__rl": true,
          "value": "117w1aMJBBGHfuB3fhQo4SJ5ZVxMOVL3RDiGTozlObL8",
          "mode": "list",
          "cachedResultName": "Email Reminders",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/117w1aMJBBGHfuB3fhQo4SJ5ZVxMOVL3RDiGTozlObL8/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/117w1aMJBBGHfuB3fhQo4SJ5ZVxMOVL3RDiGTozlObL8/edit#gid=0"
        },
        "numberToDelete": 10
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        384,
        0
      ],
      "id": "2d175dbf-59c3-49a6-a416-10a41801aef2",
      "name": "Clean previous events",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "MWejSXDbMpA4Zwri",
          "name": "Google Sheets account VC"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "117w1aMJBBGHfuB3fhQo4SJ5ZVxMOVL3RDiGTozlObL8",
          "mode": "list",
          "cachedResultName": "Email Reminders",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/117w1aMJBBGHfuB3fhQo4SJ5ZVxMOVL3RDiGTozlObL8/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/117w1aMJBBGHfuB3fhQo4SJ5ZVxMOVL3RDiGTozlObL8/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Email": "={{ $json.attendees[0].email }}",
            "Set": "N",
            "Status": "Ready",
            "Subject": "==CONCATENATE(\"Dear \", INDIRECT(\"A\"&ROW()),\", looking forward to chat this afternoon\")",
            "Body": "=If something comes up, just let me know.\n\n-Carlos Alba"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Subject",
              "displayName": "Subject",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Body",
              "displayName": "Body",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Set",
              "displayName": "Set",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        768,
        0
      ],
      "id": "36f36ac8-37e2-47db-a78b-4076e5dcc936",
      "name": "Add today's events",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "MWejSXDbMpA4Zwri",
          "name": "Google Sheets account VC"
        }
      }
    },
    {
      "parameters": {
        "operation": "getAll",
        "calendar": {
          "__rl": true,
          "value": "carlosalbavc@gmail.com",
          "mode": "list",
          "cachedResultName": "carlosalbavc@gmail.com"
        },
        "limit": 10,
        "timeMax": "={{ $now.plus({ day: 1 }) }}",
        "options": {}
      },
      "type": "n8n-nodes-base.googleCalendar",
      "typeVersion": 1.3,
      "position": [
        576,
        0
      ],
      "id": "122563f1-9dc5-45e8-b2cf-c2b5d9d0ccab",
      "name": "Get calendar's events",
      "credentials": {
        "googleCalendarOAuth2Api": {
          "id": "o8lC6PmGdgMZlXqP",
          "name": "Google Calendar VC account"
        }
      }
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 7,
              "triggerAtMinute": 5
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        192,
        0
      ],
      "id": "99805c8d-9dfd-4f20-86d1-5925c40486be",
      "name": "Schedule Trigger - Get Events"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 10,
              "triggerAtMinute": 5
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        192,
        224
      ],
      "id": "599a525e-b6cd-4834-991b-29fe60aebaeb",
      "name": "Schedule Trigger Send Reminders"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "117w1aMJBBGHfuB3fhQo4SJ5ZVxMOVL3RDiGTozlObL8",
          "mode": "list",
          "cachedResultName": "Email Reminders",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/117w1aMJBBGHfuB3fhQo4SJ5ZVxMOVL3RDiGTozlObL8/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/117w1aMJBBGHfuB3fhQo4SJ5ZVxMOVL3RDiGTozlObL8/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        384,
        224
      ],
      "id": "07c0f191-d8a6-4e1a-8414-c89b4ee43a2d",
      "name": "Get row(s) in sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "MWejSXDbMpA4Zwri",
          "name": "Google Sheets account VC"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "={{ $json.Email }}",
        "subject": "={{ $json.Subject }}",
        "emailType": "text",
        "message": "={{ $json.Body }}",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        768,
        224
      ],
      "id": "feb9184d-e8b3-4de8-a609-285a29214e0a",
      "name": "Send a message",
      "webhookId": "5ce13f9e-84d9-4ba0-b9b2-5a9f863c8738",
      "credentials": {
        "gmailOAuth2": {
          "id": "x37Rft2EXh0Ze73c",
          "name": "Gmail account VC"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "14b0128a-51bf-4934-b27a-26feba0e6393",
              "leftValue": "={{ $json.Set }}",
              "rightValue": "Y",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            },
            {
              "id": "42dfd4ac-7d66-459c-97a5-15c837ff1b67",
              "leftValue": "={{ $json.Status }}",
              "rightValue": "Ready",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2.2,
      "position": [
        576,
        224
      ],
      "id": "1119d507-9caf-43cc-a693-cded1072c175",
      "name": "Filter"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "117w1aMJBBGHfuB3fhQo4SJ5ZVxMOVL3RDiGTozlObL8",
          "mode": "list",
          "cachedResultName": "Email Reminders",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/117w1aMJBBGHfuB3fhQo4SJ5ZVxMOVL3RDiGTozlObL8/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "Sheet1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/117w1aMJBBGHfuB3fhQo4SJ5ZVxMOVL3RDiGTozlObL8/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Email": "={{ $('Filter').item.json.Email }}",
            "Status": "Sent"
          },
          "matchingColumns": [
            "Email"
          ],
          "schema": [
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Subject",
              "displayName": "Subject",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Body",
              "displayName": "Body",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Set",
              "displayName": "Set",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.6,
      "position": [
        960,
        224
      ],
      "id": "3c91034d-b7d6-41f9-9612-0103290c3244",
      "name": "Update sent status",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "MWejSXDbMpA4Zwri",
          "name": "Google Sheets account VC"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Clean previous events": {
      "main": [
        [
          {
            "node": "Get calendar's events",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get calendar's events": {
      "main": [
        [
          {
            "node": "Add today's events",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger - Get Events": {
      "main": [
        [
          {
            "node": "Clean previous events",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger Send Reminders": {
      "main": [
        [
          {
            "node": "Get row(s) in sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get row(s) in sheet": {
      "main": [
        [
          {
            "node": "Filter",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Filter": {
      "main": [
        [
          {
            "node": "Send a message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a message": {
      "main": [
        [
          {
            "node": "Update sent status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "b2a76257-26e3-49e3-86c6-3a4964587261",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "a5a00baa12a85b9086302f700a603aad89b3f2a6035d43cbd514404a64493513"
  },
  "id": "Kxf59LWIMvvN07oN",
  "tags": []
}